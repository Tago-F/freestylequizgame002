# AIクイズアプリ タスク計画書

## 1. 概要

このドキュメントは、「AIクイズアプリ」のMVP（Minimum Viable Product）開発におけるタスクリストと計画を定義する。
各タスクには、作業内容、難易度、優先度を割り振る。

- **難易度**:
    - **高**: 複雑なロジック、新しい技術の導入、または広範囲な影響を伴うタスク
    - **中**: 標準的な実装だが、複数のコンポーネントやロジックが絡むタスク
    - **低**: 単純な設定、定型的な実装、または軽微な修正で完了するタスク

- **優先度**:
    - **高**: このタスクが完了しないと他の多くのタスクがブロックされる、またはコア機能に必須
    - **中**: 重要だが、他のタスクと並行して進められる、または代替手段が存在する
    - **低**: コア機能ではない、または後回しにしても影響が少ない改善タスク

---

## 2. タスク一覧

### カテゴリ1: プロジェクト基盤構築 (Setup)

| ID | タスク内容 | 難易度 | 優先度 | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| S-01 | Spring Boot プロジェクトの初期設定 | 低 | 高 | Spring Initializr を使用。Java, Spring Web, Spring AI (Vertex AI) の依存関係を追加。 |
| S-02 | Angular プロジェクトの初期設定 | 低 | 高 | Angular CLI を使用。`ng new` でプロジェクトを作成。 |
| S-03 | プロジェクト構造の決定 | 低 | 高 | バックエンドとフロントエンドのディレクトリ構成を決定する。(例: `backend/`, `frontend/`) |
| S-04 | CORS設定 (Spring Boot) | 低 | 高 | AngularからのAPIリクエストを許可するための設定。完了。 |

### カテゴリ2: バックエンド開発 (Spring Boot)

| ID | タスク内容 | 難易度 | 優先度 | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| BE-01 | APIデータモデル(DTO)の実装 | 低 | 高 | `GenerateQuizRequest`, `QuizResponse`, `HintRequest`, `HintResponse`, `ErrorResponse` のJavaクラスを作成。完了。 |
| BE-02 | クイズ生成API (`/quiz/generate`) のコントローラー実装 | 中 | 高 | `POST /api/v1/quiz/generate` のエンドポイントを作成。リクエストを受け取り、サービスクラスを呼び出す。完了。 |
| BE-03 | AI連携サービスクラスの実装 (クイズ生成) | 高 | 高 | Spring AI を使用して Vertex AI Gemini API と連携。プロンプトを組み立て、クイズを生成させる。完了。 |
| BE-04 | ヒント生成API (`/quiz/hint`) のコントローラー実装 | 中 | 高 | `POST /api/v1/quiz/hint` のエンドポイントを作成。完了。 |
| BE-05 | AI連携サービスクラスの実装 (ヒント生成) | 高 | 高 | クイズ情報に基づき、Gemini API にヒント生成を指示する。完了。 |
| BE-06 | グローバル例外ハンドラーの実装 | 中 | 中 | APIエラー時に `ErrorResponse` 形式で統一されたエラーを返すための設定。完了。 |
| BE-07 | プロンプトテンプレートの作成 | 中 | 高 | クイズ生成・ヒント生成のためのプロンプトを `prompt.txt` などの外部ファイルで管理する。完了。 |
| BE-08 | APIの単体テスト/結合テスト | 中 | 中 | JUnit, Mockito, MockMvc などを使用して、APIが仕様通りに動作することを確認する。キャンセル済み。 |

### カテゴリ3: フロントエンド開発 (Angular)

| ID | タスク内容 | 難易度 | 優先度 | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| FE-01 | 画面遷移のルーティング設定 | 低 | 高 | `app-routing.module.ts` に3画面のパスを設定。完了。 |
| FE-02 | プレイヤー登録画面コンポーネントの実装 | 中 | 高 | プレイヤーの動的な追加・削除機能、入力フォームの実装。完了。 |
| FE-03 | クイズ設定画面コンポーネントの実装 | 低 | 高 | ジャンルと難易度の選択UIを作成。完了。 |
| FE-04 | クイズプレイ画面コンポーネントの実装 | 高 | 高 | ヘッダー、クイズエリア、スコアエリアの3つの主要エリアを持つレイアウトを構築。完了。 |
| FE-05 | 状態管理サービスの作成 (プレイヤー/スコア) | 中 | 高 | プレイヤーリストと各スコアを管理するサービスを作成 (例: `PlayerStateService`)。完了。 |
| FE-06 | 状態管理サービスの作成 (クイズ) | 中 | 高 | 現在のクイズ情報、ゲーム設定（ジャンル、難易度）を管理するサービスを作成 (例: `QuizStateService`)。完了。 |
| FE-07 | API通信サービスの作成 | 中 | 高 | Spring Boot API を呼び出すための `HttpClient` を使用したサービスを作成 (例: `ApiService`)。完了。 |
| FE-08 | クイズプレイ画面のロジック実装 (状態遷移) | 高 | 高 | 「ローディング中」「回答受付中」「解説表示」の状態に応じて表示を切り替えるロジックを実装。完了。 |
| FE-09 | ローディングスピナーコンポーネントの実装 | 低 | 中 | API通信中などに表示する共通コンポーネント。完了。 |
| FE-10 | UI/UXのスタイリング | 中 | 中 | CSSフレームワーク（例: Angular Material, Bootstrap）を導入し、ワイヤーフレームに基づき画面をデザイン。完了。 |
| FE-11 | 確認ダイアログの実装 | 低 | 中 | 「ゲームをリセット」ボタン押下時に表示する確認モーダル。 |

### カテゴリ4: 統合・テスト (Integration & Testing)

| ID | タスク内容 | 難易度 | 優先度 | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| IT-01 | フロントエンドとバックエンドの統合テスト | 中 | 高 | 実際に画面を操作し、API連携が正しく行われるかを確認する。 |
| IT-02 | E2E (End-to-End) テストシナリオの作成と実施 | 高 | 低 | プレイヤー登録からクイズ回答までの一連の流れを自動テストする。(MVPでは手動でも可) |
| IT-03 | クロスブラウザテスト | 低 | 低 | 主要なブラウザ（Chrome, Firefoxなど）でレイアウト崩れや動作不良がないか確認。 |

---

## 3. 改善タスク一覧 (MVPリリース後)

### カテゴリ5: ゲームバランス調整

| ID | タスク内容 | 難易度 | 優先度 | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| GB-01 | クイズ出題の重複回避機能の実装 | 中 | 高 | AIへのプロンプトを工夫し、過去の出題と重複しないクイズを生成させる。 |
| GB-02 | 関連ドキュメントの更新 | 低 | 高 | GB-01の実装に伴い、要件定義書、API仕様書、画面設計書、タスク計画書を更新する。 |
| GB-03 | バックエンド改修 (DTO, Service, Prompt) | 中 | 高 | `GenerateQuizRequest`に`previousQuestions`を追加。Spring AI標準の`PromptTemplate`では条件分岐が扱えないため、StringTemplateライブラリを直接利用してプロンプトを生成するように`QuizService`を修正。 |
| GB-04 | フロントエンド改修 (APIリクエスト) | 中 | 高 | クイズ生成APIを呼び出す際に、`QuizStateService`から過去の出題リストを取得し、リクエストに含める。 |
