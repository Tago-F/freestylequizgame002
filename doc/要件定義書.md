# AIクイズアプリ 要件定義書

## 1. プロジェクト概要

### 1.1. 目的

このアプリは、AIが出題するクイズを通じて、複数のユーザーがリアルタイムで楽しみを共有できるWebアプリケーションを提供することを目的とする。

### 1.2. コンセプト

- AI (Spring AI + Vertex AI Gemini) がリアルタイムでクイズ（問題、4択、解説）を生成する。

- 複数ユーザーが同じ画面を共有し、グループでクイズイベントとして楽しめる。

### 1.3. ペルソナ

- メイン: 学校、会社、サークルなどの集まりで、手軽に盛り上がれるシンプルなクイズゲームを探しているグループ。

- サブ: IT（プログラミングなど）の勉強会で、手軽に知識を確認したいIT初心者や学習者のグループ。

- サブ: 一人でシンプルなクイズをプレイしたいユーザー。

## 2. 機能要件

ここでは、ユーザーが体験する機能（ユーザーストーリー）を詳細化し、具体的な仕様を定義する。

### 2.1. プレイヤー管理機能

- ユーザーストーリー: ユーザーがプレイヤー名登録する。

- 仕様:

    - 「プレイヤー登録画面」にて、プレイヤー名を1〜16人まで登録できる。

    - 登録はクイズ開始前に全員分まとめて行う。

    - 登録されたプレイヤー情報（スコア、名前、アイコン）は、画面下部に常に表示される。（例: [+][-] 0 👤田中）

    - プレイヤーごとに識別用の色（自動割り当て）と、選択可能なシンプルなアイコン（任意）を設定できる。

### 2.2. クイズ設定機能

- ユーザーストーリー: クイズのジャンルと難易度を選択する。

- 仕様:

    - 「ゲーム設定画面」にて、以下のジャンルからクイズのテーマを単一選択できる。

        - 一般: 歴史, 化学, 地理, 映画, アニメ

        - IT系: プログラミングの概念, Java, C#, Python, SQL

        - その他: ランダム (全ジャンルから)

    - 「ゲーム設定画面」にて、以下の難易度を選択できる。

        - かんたん, ふつう, むずかしい

    - 選択されたジャンルと難易度は、バックエンド（Spring AI）がAIへクイズ生成を指示する際のプロンプト（指示文）に利用される。

### 2.3. クイズプレイ機能

- ユーザーストーリー: AIからクイズ（4択）が出題され、ヒントも貰え、回答できる。

- 仕様:

    - 「出題」ボタンを押すと、バックエンド（Spring AI）がAI APIを呼び出し、設定に基づいたクイズ（問題文、4択の選択肢、正解の選択肢、解説）を生成する。

    - 画面には問題文と4つの選択肢（A, B, C, Dなど）を表示する。

    - 「ヒント」ボタン押下時、バックエンドはAIに対し、その問題に関連する追加のヒント（関連キーワードや、答えを補足する簡単な説明文）を要求し、表示する。

    - ユーザーが選択肢を選び「回答」ボタンを押すと、AIが生成した「正解の選択肢」と照合し、**自動で正誤判定（正解/不正解）**を行う。

    - 回答後、画面は「正解の選択肢」およびAIが生成した「解説」を表示する。

    - （補足）AIによる自動判定は表示するが、最終的なスコア加算（2.4参照）は手動で行う。

    - クイズの連続的な重複を防ぐため、フロントエンドは直近の出題履歴（問題文のリスト）を保持する。

    - 「出題」ボタン押下時、この履歴をバックエンドに送信し、バックエンドはそれをAIへの指示に含めることで、過去問と異なる新しいクイズの生成を促す。

### 2.4. スコア・履歴管理機能

- ユーザーストーリー: ユーザーの正答数を手動でカウントできる。

- 仕様:

    - 2.3の正解発表後、各プレイヤーは画面下部の自分の名前の横にある [+] ボタンを押してスコアを加算する。（[-] ボタンで減点も可能）

    - (MVPスコープ): スコア、プレイヤー情報、クイズ履歴は一切永続化されない。

    - データはすべてフロントエンド（Angular）のメモリ上でのみ保持され、ページをリロード（再読み込み）するとリセットされる。

## 3. 非機能要件

### 3.1. パフォーマンス

- AI（Gemini API）へのリクエスト（クイズ生成、ヒント生成、正誤判定/解説）が、7秒以内に完了し、画面に反映されることを目標とする。

- 待機中は、ローディング中であることが分かるUI（ローディングスピナーなど）を表示する。

- 個人開発のMVPであるため、コスト（API利用料）を優先する。上記の目標時間を超える場合も、コスト最適化の範囲内であれば許容する。

### 3.2. データ管理/永続性

- (MVPスコープ): 本アプリのMVPでは、プレイヤー情報やクイズ履歴の永続化（データベース保存）は行わない。

- データはすべてフロントエンド（Angular）のメモリ上で管理され、ブラウザをリロードまたは閉じると消失する（セッション限り）。

### 3.3. セキュリティ

- (MVPスコープ): ユーザーアカウント登録やログイン機能はなく、個人情報や機密データを扱わないため、セキュリティ要件は特になしとする。

### 3.4. 可用性

- (MVPスコープ): 個人開発のMVPであり、永続化データもないため、可用性に関する特別な要件は特になしとする。（ベストエフォート）

## 4. 開発スコープ

### 4.1. MVP (今回開発する範囲)

- プレイヤー登録機能（1〜16人、色・アイコン選択、メモリ保持のみ）

- クイズ設定機能（ジャンル、難易度選択）

- AIによるクイズ出題機能（4択、解説生成）

- AIによるヒント生成機能

- 手動によるスコア加算機能

### 4.2. MVP対象外 (将来的な拡張)

- クイズ履歴の保存機能 (PostgreSQL連携)

- 過去問の復習機能

- ユーザーアカウント登録（ログイン）機能

- 複数ブラウザ（PC、スマホ）間でのリアルタイムな状態同期

## 5. 使用スタック (MVP)

- バックエンド： Spring Boot (Spring AI)

    - AI（Vertex AI Gemini API）との連携、クイズ生成ロジックの実行

- フロントエンド： Angular

    - UIの描画、プレイヤー情報とスコアの（一時的な）状態管理

- AI： Vertex AI Gemini API

- データベース： PostgreSQL (MVP対象外)

    - (将来的な履歴保存機能の実装時に導入を検討する)

- 開発環境： Rocky 9（WSL2）