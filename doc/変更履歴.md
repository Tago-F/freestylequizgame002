# 変更履歴

このドキュメントは、プロジェクトの主要な変更点を記録します。

## このファイルの運用ルール

### 記述フォーマット
- 新しいバージョンの変更履歴は、このルールの下（`---`区切り線の下）に追記してください。
- タイトルは `## [バージョン番号] - YYYY-MM-DD` の形式で記述します。

### バージョニング
バージョン番号は `X.Y.Z` の形式（セマンティックバージョニング）に従います。
- **X (メジャー)**: 後方互換性のないAPI変更や、大幅な機能刷新があった場合に加算します。
- **Y (マイナー)**: 後方互換性を保ったまま、新しい機能が追加された場合に加算します。
- **Z (パッチ)**: 後方互換性を保ったまま、バグ修正やリファクタリングが行われた場合に加算します。

### カテゴリ
変更内容は、以下のいずれかのカテゴリ見出しの下に箇条書きで記述します。

- `### 追加 (Added)`: 新機能の追加。
- `### 変更 (Changed)`: 既存機能の仕様変更。
- `### 修正 (Fixed)`: バグ修正。
- `### 削除 (Removed)`: 削除された機能。
- `### 非推奨 (Deprecated)`: 将来的に削除予定の機能。
- `### セキュリティ (Security)`: 脆弱性の修正。
- `### ドキュメント (Documentation)`: ドキュメントのみの変更。

---

## [1.5.0] - 2025-12-06

### 追加 (Added)
- モード選択画面を追加
- 「ソロプレイ」「マルチプレイ」の選択肢を追加

### 変更 (Changed)
- ルーティング構成をリファクタリングし、クイズ機能を `/quiz/` 配下に階層化

---

## [1.4.6] - 2025-12-03

### 変更 (Changed)
- バックエンドのリファクタリングを実施
- クイズ履歴テーブル用 Entity, Repository の削除
- フロントエンド側の設定項目をバックエンドに移管

---

## [1.4.5] - 2025-12-02

### 変更 (Changed)
- クイズ履歴の保存形式を詳細化
- バックエンドのリファクタリングを実施

---

## [1.4.4] - 2025-11-30

### 変更 (Changed)
- アプリ全体の背景色を、より目に優しい「シルキー・パステル（Silky Pastel）」な配色に変更

---

## [1.4.3] - 2025-11-30

### 追加 (Added)
- クイズ設定画面の問題数選択肢に「5問」を追加

---

## [1.4.2] - 2025-11-30

### 修正 (Fixed)
- クイズ設定画面にて、画面サイズや拡大率によってコンテンツ上部が見切れてしまう不具合を修正

---

## [1.4.1] - 2025-11-30

### 変更 (Changed)
- クイズ設定画面の初期値を変更（難易度: ふつう、モード: ターン制、問題数: 15問）

---

## [1.4.0] - 2025-11-29

### 変更 (Changed)

- **ジャンル選択肢の拡充**
  - クイズ設定画面のジャンル選択肢を大幅に拡充しました。
  - アニメ、映画、エンタメ、音楽、教養、サイエンス、ITスキルの各カテゴリに、より詳細なジャンルを追加しました。

---

## [1.3.0] - 2025-11-29 (AI 生成による履歴作成失敗の為、手動で記載)

### 追加 (Added)

- **クイズ出題数設定を追加**
  - クイズ設定画面に、クイズの出題数を決める設定を追加。
  - クイズプレイ画面に、現在のクイズ出題数を表示。

- **リザルト画面の追加**
  - クイズ出題数に達すると、リザルト画面を表示できるモーダルを追加。
  - 正解数をもとにランキングが表示されるリザルト画面を追加。

### 変更 (Changed)

---


## [1.2.3] - 2025-11-29 (手動で変更)

### 変更 (Changed)

- **クイズ多様性のアップ**
  - クイズ文章の文字数を50文字から75文字に拡張。
  - 多様性に富む問題文が出題されるようにプロンプトを調整。
  - `backend/src/main/resources/prompts/quiz-generation.st`

- **Gemini 使用モデルの変更**
  - 使用モデルを gemini-2.5-flash-lite から gemini-2.5-flash に変更。
  - `backend/src/main/resources/application.properties`

---


## [1.2.2] - 2025-11-29

### 変更 (Changed)

- **クイズ重複防止機能の強化**
  - AIに過去問として連携する問題の件数を、15件から30件に引き上げました。これにより、短時間で同じジャンルのクイズを連続してプレイした場合の重複率がさらに低下します。
  - `QuizServiceImpl.java` および関連ドキュメント (`要件定義書.md`, `タスク計画書.md`, `変更履歴.md`) を更新。

---

## [1.2.1] - 2025-11-29

### ドキュメント (Documentation)

- **ドキュメントの構成をリファクタリング**
  - `画面設計書.md`: 肥大化したファイルを各画面ごとに分割し、可読性を向上させました。
  - `タスク計画書.md`: タスクの進捗状況を管理しやすくするため、「備考」欄にあったステータスを「タスク状態」列として正式に分離しました。

---

## [1.2.0] - 2025-11-24

### ドキュメント (Documentation)

- **バージョン情報・更新履歴表示機能の追加に向けたドキュメント更新**
  - `要件定義書.md`: 機能要件に「バージョン・更新履歴表示機能」を追加。データ管理要件を更新。
  - `画面設計書.md`: ゲーム選択画面のワイヤーフレームを更新し、バージョン情報、更新履歴リンク、モーダル表示のレイアウトを追加。
  - `タスク計画書.md`: 新機能の実装に向けたタスクリスト（カテゴリ8）を追加。
  - `変更履歴.md`: 本更新内容を追記。

---

## [1.1.0] - 2025-11-24

### 変更 (Changed)

- **クイズ重複防止機能の仕様を詳細化**
  - これまでデータベース内の全問題と照合していましたが、**選択されたジャンルと同一**の出題履歴のみを参照するように変更。
  - 参照する出題履歴を、全件ではなく**最新の30件**に限定。
- **バックエンド**
  - `AskedQuestion`エンティティに`genre`と`createdAt`（出題日時）カラムを追加。
  - `AskedQuestionRepository`を改修し、ジャンルで絞り込んで最新30件を取得するメソッドを実装。
  - `QuizServiceImpl`を改修し、新しいリポジトリのメソッドを呼び出し、クイズ保存時にジャンルも記録するように変更。
- **ドキュメント**
  - `要件定義書`、`タスク計画書`を上記の新しい仕様に合わせて更新。

---

## [1.0.0] - 2025-11-24

### 追加 (Added)

- **クイズ出題履歴の永続化機能**
  - これまでセッション（ブラウザのリロード）限りだった重複防止機能を、データベース（PostgreSQL）に保存することで永続化しました。
  - これにより、アプリケーションを再起動したり、別のユーザーが利用したりしても過去の問題と重複しません。

### 変更 (Changed)

- **バックエンド**
  - Spring Data JPAとPostgreSQLの依存関係を`pom.xml`に追加。
  - `application.properties`にデータベース接続設定を追加。
  - 出題履歴を保存するための`AskedQuestion`エンティティと`AskedQuestionRepository`リポジトリを新規作成。
  - `QuizServiceImpl`のロジックを全面的に改修。フロントエンドから過去問リストを受け取る代わりに、データベースから履歴を取得し、生成したクイズをデータベースに保存するアーキテクチャに変更。
  - `GenerateQuizRequest` DTOから`previousQuestions`フィールドを削除。

- **フロントエンド**
  - `quiz-state.service.ts`から、これまで行っていた`quizHistory`（出題履歴）の管理ロジックをすべて削除し、実装を簡略化。
  - `quiz.model.ts`の`GenerateQuizRequest`型定義を更新。

- **ドキュメント**
  - `要件定義書`、`API仕様書`、`タスク計画書`にデータベース永続化の仕様を反映。

---

## [0.1.0] - (過去の変更)

### 追加 (Added)

- MVP（Minimum Viable Product）の基本機能を実装。
  - Spring Boot + Angularによるプロジェクト基盤。
  - AI (Gemini) によるリアルタイムなクイズ生成機能。
  - 複数プレイヤー登録、スコア管理機能。
  - ゲームモード選択機能（全員回答、ターン制）。
  - フロントエンドのセッション内でのみ有効な、簡易的なクイズ重複防止機能。