# 変更履歴

このドキュメントは、プロジェクトの主要な変更点を記録します。

## このファイルの運用ルール

### 記述フォーマット
- 新しいバージョンの変更履歴は、このルールの下（`---`区切り線の下）に追記してください。
- タイトルは `## [バージョン番号] - YYYY-MM-DD` の形式で記述します。

### バージョニング
バージョン番号は `X.Y.Z` の形式（セマンティックバージョニング）に従います。
- **X (メジャー)**: 後方互換性のないAPI変更や、大幅な機能刷新があった場合に加算します。
- **Y (マイナー)**: 後方互換性を保ったまま、新しい機能が追加された場合に加算します。
- **Z (パッチ)**: 後方互換性を保ったまま、バグ修正やリファクタリングが行われた場合に加算します。

### カテゴリ
変更内容は、以下のいずれかのカテゴリ見出しの下に箇条書きで記述します。

- `### 追加 (Added)`: 新機能の追加。
- `### 変更 (Changed)`: 既存機能の仕様変更。
- `### 修正 (Fixed)`: バグ修正。
- `### 削除 (Removed)`: 削除された機能。
- `### 非推奨 (Deprecated)`: 将来的に削除予定の機能。
- `### セキュリティ (Security)`: 脆弱性の修正。
- `### ドキュメント (Documentation)`: ドキュメントのみの変更。

---

## [1.2.2] - 2025-11-29

### 変更 (Changed)

- **クイズ重複防止機能の強化**
  - AIに過去問として連携する問題の件数を、15件から30件に引き上げました。これにより、短時間で同じジャンルのクイズを連続してプレイした場合の重複率がさらに低下します。
  - `QuizServiceImpl.java` および関連ドキュメント (`要件定義書.md`, `タスク計画書.md`, `変更履歴.md`) を更新。

---

## [1.2.1] - 2025-11-29

### ドキュメント (Documentation)

- **ドキュメントの構成をリファクタリング**
  - `画面設計書.md`: 肥大化したファイルを各画面ごとに分割し、可読性を向上させました。
  - `タスク計画書.md`: タスクの進捗状況を管理しやすくするため、「備考」欄にあったステータスを「タスク状態」列として正式に分離しました。

---

## [1.2.0] - 2025-11-24

### ドキュメント (Documentation)

- **バージョン情報・更新履歴表示機能の追加に向けたドキュメント更新**
  - `要件定義書.md`: 機能要件に「バージョン・更新履歴表示機能」を追加。データ管理要件を更新。
  - `画面設計書.md`: ゲーム選択画面のワイヤーフレームを更新し、バージョン情報、更新履歴リンク、モーダル表示のレイアウトを追加。
  - `タスク計画書.md`: 新機能の実装に向けたタスクリスト（カテゴリ8）を追加。
  - `変更履歴.md`: 本更新内容を追記。

---

## [1.1.0] - 2025-11-24

### 変更 (Changed)

- **クイズ重複防止機能の仕様を詳細化**
  - これまでデータベース内の全問題と照合していましたが、**選択されたジャンルと同一**の出題履歴のみを参照するように変更。
  - 参照する出題履歴を、全件ではなく**最新の30件**に限定。
- **バックエンド**
  - `AskedQuestion`エンティティに`genre`と`createdAt`（出題日時）カラムを追加。
  - `AskedQuestionRepository`を改修し、ジャンルで絞り込んで最新30件を取得するメソッドを実装。
  - `QuizServiceImpl`を改修し、新しいリポジトリのメソッドを呼び出し、クイズ保存時にジャンルも記録するように変更。
- **ドキュメント**
  - `要件定義書`、`タスク計画書`を上記の新しい仕様に合わせて更新。

---

## [1.0.0] - 2025-11-24

### 追加 (Added)

- **クイズ出題履歴の永続化機能**
  - これまでセッション（ブラウザのリロード）限りだった重複防止機能を、データベース（PostgreSQL）に保存することで永続化しました。
  - これにより、アプリケーションを再起動したり、別のユーザーが利用したりしても過去の問題と重複しません。

### 変更 (Changed)

- **バックエンド**
  - Spring Data JPAとPostgreSQLの依存関係を`pom.xml`に追加。
  - `application.properties`にデータベース接続設定を追加。
  - 出題履歴を保存するための`AskedQuestion`エンティティと`AskedQuestionRepository`リポジトリを新規作成。
  - `QuizServiceImpl`のロジックを全面的に改修。フロントエンドから過去問リストを受け取る代わりに、データベースから履歴を取得し、生成したクイズをデータベースに保存するアーキテクチャに変更。
  - `GenerateQuizRequest` DTOから`previousQuestions`フィールドを削除。

- **フロントエンド**
  - `quiz-state.service.ts`から、これまで行っていた`quizHistory`（出題履歴）の管理ロジックをすべて削除し、実装を簡略化。
  - `quiz.model.ts`の`GenerateQuizRequest`型定義を更新。

- **ドキュメント**
  - `要件定義書`、`API仕様書`、`タスク計画書`にデータベース永続化の仕様を反映。

---

## [0.1.0] - (過去の変更)

### 追加 (Added)

- MVP（Minimum Viable Product）の基本機能を実装。
  - Spring Boot + Angularによるプロジェクト基盤。
  - AI (Gemini) によるリアルタイムなクイズ生成機能。
  - 複数プレイヤー登録、スコア管理機能。
  - ゲームモード選択機能（全員回答、ターン制）。
  - フロントエンドのセッション内でのみ有効な、簡易的なクイズ重複防止機能。
